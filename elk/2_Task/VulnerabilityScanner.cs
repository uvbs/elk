namespace Elk.Task
{
  using System.Collections.Generic;
  using Elk.DataTypes;
  using Elk.DataTypes.Enumerations;
  using Elk.DataTypes.Interfaces;
  using Elk.Vulnerabilities;


  public class VulnerabilityScanner
  {

    #region MEMBERS
    

    #endregion


    #region PROPERTIES
    

    #endregion


    #region PUBLIC

    public VulnerabilityScanner()
    {
    }


    public List<IVulnerabilityDefinition> StartScanning(DataForVulnerabilityScanner vulnData)
    {
      List<IVulnerabilityDefinition> foundVulns = new List<IVulnerabilityDefinition>();

      foreach (EnumVulnerability key in VulnerabilityDefinitions.Instance.Catalog.Keys)
      {
        if (VulnerabilityDefinitions.Instance.Catalog[key].IsTargetVulnerable(vulnData))
        {
          foundVulns.Add(VulnerabilityDefinitions.Instance.Catalog[key]);
        }
      }

      return foundVulns;
    }

    #endregion

  }
}
